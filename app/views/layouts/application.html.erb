<!DOCTYPE html>
<html lang="<%= I18n.locale %>">
  <head>
    <title><%= meta_title%></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <meta name="description" content="<%= meta_description %>" />
    <meta name="keywords" content="dyson sphere program, blueprints, dyson sphere blueprints, dsp, dsp blueprints">

    <meta property="og:title" content="<%= meta_title %>" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="<%= request.original_url %>" />
    <meta property="og:image" content="<%= meta_image %>" />
    <meta property="og:description" content="<%= meta_description %>" />
    <meta property="og:site_name" content="<%= meta_title %>" />

    <%= favicon_link_tag asset_path('favicon/favicon.ico') %>
    <link rel="apple-touch-icon" sizes="180x180" href="<%= asset_path('favicon/apple-touch-icon.png') %>">
    <link rel="icon" type="image/png" sizes="32x32" href="<%= asset_path('favicon/favicon-32x32.png') %>">
    <link rel="icon" type="image/png" sizes="16x16" href="<%= asset_path('favicon/favicon-16x16.png') %>">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>

    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload', defer: true %>
  </head>

  <body>
      <div class="wrapper" data-controller="cookieConsent" >
      <%= render 'shared/navbar' %>
      <%= render 'shared/flashes' %>
      <%= render 'shared/cookie_consent_banner' %>

      <div class="l-wrapper">
        <%= yield %>
      </div>

      <footer class="l-footer">
        <span class="l-footer-item made-with"><%= t('footer.made_with') %>&nbsp;&nbsp;❤️</span>
        <span class="l-footer__separator">|</span>
        <span class="l-footer-item issues">
          <%= t('footer.issue_notice') %> <%= t('footer.suggestion') %> <%= t('footer.tell_me') %>&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://github.com/gabriel-dehan/dyson-sphere-blueprints/issues"><%= t('common.here', default: 'here') %>.</a> <%= t('footer.or') %> <a target="_blank" rel="noopener noreferrer" href="https://www.reddit.com/user/Diacred"><%= t('footer.send_dm') %></a>
        </span>
        <span class="l-footer__separator">|</span>
        <span class="l-footer-item source-code">
          <a target="_blank" rel="noopener noreferrer" href="https://github.com/gabriel-dehan/dyson-sphere-blueprints"><%= t('footer.source_code') %></a>
        </span>
        <span class="l-footer__separator">|</span>
        <span class="l-footer-item legal">
          <%= link_to t('pages.privacy', default: 'Privacy'), privacy_path %> · <%= link_to t('pages.cookies', default: 'Cookies'), cookies_path %> · <%= link_to t('pages.terms', default: 'Terms'), terms_path %>
        </span>
        <span class="l-footer__separator">|</span>
        <span class="l-footer-item cookie-settings">
          <a href="#" data-action="click->cookieConsent#revokeConsent"><%= t('footer.cookie_settings') %></a>
        </span>
      </footer>
    </div>

    <script>
      // GA4 initialization stub - actual loading happens after cookie consent
      window.dataLayer = window.dataLayer || [];
      window.GA_MEASUREMENT_ID = 'G-2RYPZC6X3B';
    </script>
  </body>
</html>
